# üöÄ JAYNA GYRO TASK MANAGER - AI DEVELOPMENT INSTRUCTIONS

**READ THIS FILE FIRST IN EVERY SESSION** - This contains critical development patterns, completed work, and roadmap.

## üéØ DEVELOPMENT PHILOSOPHY & METHODOLOGY

### Core Principles
- **LIVE DATA ONLY**: Never use mock data, defaults, or fallbacks. All features must use real database queries.
- **PRODUCTION TESTING**: Always test on live Vercel deployment, never in development mode.
- **INCREMENTAL DEVELOPMENT**: One feature at a time, with todo lists to track progress.
- **IMMEDIATE DEPLOYMENT**: Commit ‚Üí Push ‚Üí Deploy ‚Üí Test ‚Üí Get Feedback ‚Üí Revise until perfect.

### Development Workflow
1. **Create Todo List**: Break down feature into specific, testable steps
2. **Implement ONE Item**: Focus on single todo item at a time
3. **Mark In-Progress**: Update todo status when starting work
4. **Code & Test**: Build with real database calls only
5. **Mark Complete**: Update todo when item is done
6. **Commit & Push**: Descriptive commit message with all changes
7. **Deploy to Vercel**: User tests on live deployment
8. **Get Feedback**: User provides feedback on live app
9. **Revise if Needed**: Fix issues, push again, repeat until perfect
10. **Move to Next Item**: Only when current item is 100% working

## üìä CURRENT APPLICATION STATE

### Database Schema (Supabase)
```sql
-- Core Tables
profiles (id, name, email, role, created_at)
tasks (id, title, description, requires_notes, requires_photo, created_at)
assignments (id, task_id, assigned_to, status, due_date, created_at)
completions (id, assignment_id, completed_by, notes, photo_url, completed_at)

-- Archive System
archived_assignments (id, assignment_id, task_title, assignee_name, status, week_ending, created_at)
user_weekly_stats (id, user_id, week_ending, tasks_assigned, tasks_completed, completion_rate)
weekly_reports (id, week_ending, total_assignments, total_completions, avg_completion_rate)

-- Role & Permission System
role_permissions (id, role, department)
user_permission_overrides (id, user_id, department, access_granted)

-- Manager Updates & Acknowledgments System
manager_updates (id, title, message, priority, type, requires_acknowledgment, is_active, expires_at, created_by, created_at)
update_acknowledgments (id, update_id, user_id, full_name_entered, ip_address, user_agent, acknowledged_at)
```

### User Roles & Permissions
```typescript
type UserRole = 
  | 'staff'                    // Basic staff - see only assigned tasks
  | 'foh_team_member'         // Front of house team member
  | 'boh_team_member'         // Back of house team member  
  | 'kitchen_manager'         // Manages kitchen operations
  | 'ordering_manager'        // Manages ordering and prep
  | 'lead_prep_cook'          // Lead prep responsibilities
  | 'assistant_foh_manager'   // Assistant front of house manager
  | 'manager'                 // Full manager access

type Department = 
  | 'BOH'        // Back of House
  | 'FOH'        // Front of House
  | 'AM'         // Morning/Opening
  | 'PM'         // Evening/Closing
  | 'PREP'       // Prep Kitchen
  | 'CLEAN'      // Cleaning
  | 'CATERING'   // Catering
  | 'SPECIAL'    // Special Projects
  | 'TRANSITION' // Shift Transitions
```

### API Endpoints Status ‚úÖ ALL LIVE DATA
- `/api/me` - User profile (‚úÖ Live DB)
- `/api/tasks` - Create tasks (‚úÖ Live DB)
- `/api/my-tasks` - User's assigned tasks (‚úÖ Live DB)
- `/api/assignments/[id]` - Task details (‚úÖ Live DB)
- `/api/assignments/[id]/complete` - Complete tasks (‚úÖ Live DB)
- `/api/team-activity` - Team performance data (‚úÖ Live DB)
- `/api/weekly-reports` - Weekly analytics (‚úÖ Live DB)
- `/api/manager/tasks` - Manager task overview (‚úÖ Live DB with smart department detection)
- `/api/manager/users` - User management (‚úÖ Live DB)
- `/api/manager/role-permissions` - Role configuration (‚úÖ Live DB)
- `/api/manager/user-permissions` - User permission overrides (‚úÖ Live DB)
- `/api/manager/updates` - Manager announcements (‚úÖ Live DB)
- `/api/manager/acknowledgments` - Forced signature confirmations (‚úÖ Live DB)

### Key Features Implemented ‚úÖ
- **Task Management**: Create, assign, complete tasks with photos/notes
- **Role-Based Access**: 8 distinct roles with department-based permissions
- **User Permission Overrides**: Manager can customize individual user access
- **Manager Dashboard**: Complete task overview, user management, role configuration
- **Manager Updates System**: Critical announcements with forced acknowledgments
- **Acknowledgment Modal**: Legal signature requirement for critical updates
- **Team Activity**: Real-time performance tracking and manager updates
- **Weekly Reports**: Automated archive system with analytics
- **Archive System**: Automatic weekly archiving with retention

## üîß TECHNICAL STACK

### Frontend
- **Next.js 15.5.3** (App Router)
- **React 18** with TypeScript
- **Tailwind CSS** for styling
- **NextAuth.js** for authentication
- **Shadcn/ui** components

### Backend
- **Supabase** (PostgreSQL database)
- **Row Level Security (RLS)** for data protection
- **Real-time subscriptions** capability
- **Edge Functions** for serverless API

### Deployment
- **Vercel** for hosting
- **GitHub** for version control
- **Environment Variables** for sensitive data

## üêõ CURRENT KNOWN ISSUES (TO FIX NEXT SESSION)

1. **500 Errors in Manager Dashboard**
   - Manager updates API returning 500 status
   - User permissions API may have constraint issues
   - Frontend trying to `.map()` on undefined data

2. **Error Handling Improvements Needed**
   - Add proper error boundaries
   - Ensure all API responses return consistent structure
   - Add loading states for better UX

## üìã IMMEDIATE ROADMAP (NEXT SESSION PRIORITIES)

### Phase 1: Fix Current Bugs üî•
- [ ] Debug and fix 500 errors in manager updates API
- [ ] Add proper error handling for all `.map()` operations
- [ ] Ensure all API endpoints return consistent response format
- [ ] Test manager dashboard functionality end-to-end

### Phase 2: Polish & UX Improvements üé®
- [ ] Add loading spinners for all async operations
- [ ] Implement proper error boundaries and user feedback
- [ ] Add confirmation dialogs for destructive actions
- [ ] Improve mobile responsiveness across all pages

### Phase 3: Enhanced Manager Tools üìä
- [ ] Manager analytics dashboard with charts
- [ ] Bulk task operations (assign multiple tasks at once)
- [ ] Task templates for common recurring tasks
- [ ] Advanced filtering and search capabilities

### Phase 4: Team Communication üí¨
- [ ] Real-time notifications system
- [ ] Team chat/messaging within tasks
- [ ] Shift handoff notes and checklists
- [ ] Emergency alert system

## üöÄ FUTURE FEATURE IDEAS (QUARTERLY UPDATES)

### Q1 2026: Advanced Analytics & Insights
- **Performance Trends**: Track individual and team performance over time
- **Predictive Analytics**: Identify potential bottlenecks before they happen
- **Custom Reports**: Manager-configurable reports and exports
- **Goal Setting**: Individual and team performance goals with tracking
- **Efficiency Metrics**: Time-to-completion analysis and optimization suggestions

### Q2 2026: Automation & Intelligence
- **Smart Task Assignment**: AI-suggested task assignments based on skills/availability
- **Automated Scheduling**: Intelligent task scheduling based on restaurant flow
- **Inventory Integration**: Link tasks to inventory levels and reorder alerts
- **Compliance Tracking**: Food safety and health department requirement tracking
- **Training Module**: Built-in training assignments and certification tracking

### Q3 2026: Restaurant Operations Integration
- **POS Integration**: Connect with point-of-sale for real-time order volume data
- **Supplier Integration**: Automatic delivery confirmations and inventory updates
- **Health Department Integration**: Digital inspection checklists and compliance reports
- **Payroll Integration**: Hours tracking and performance-based incentives
- **Customer Feedback Loop**: Connect customer reviews to specific operational tasks

### Q4 2026: Multi-Location & Franchise
- **Multi-Location Management**: Corporate oversight across multiple restaurants
- **Franchise Dashboard**: Standardized operations across franchise locations
- **Best Practices Sharing**: Cross-location learning and improvement sharing
- **Corporate Compliance**: Chain-wide policy enforcement and tracking
- **Regional Analytics**: Compare performance across locations and regions

### Advanced Features (2027+)
- **Voice Commands**: "Alexa, mark the prep list complete"
- **Computer Vision**: Photo analysis for food safety compliance
- **IoT Integration**: Temperature sensors, equipment monitoring
- **Mobile App**: Native iOS/Android apps with offline capability
- **API Platform**: Allow third-party integrations and custom tools

## üí° INNOVATIVE IDEAS FOR RESTAURANT TECH

### Gamification System
- **Achievement Badges**: Perfect completion streaks, speed records, team player awards
- **Leaderboards**: Friendly competition between shifts and team members
- **Point System**: Earn points for task completion, quality, and teamwork
- **Seasonal Challenges**: Special events and competitions to boost engagement

### Smart Operations
- **Weather Integration**: Adjust prep lists based on weather forecasts
- **Event Calendar**: Automatically scale task assignments for known busy periods
- **Customer Flow Prediction**: Use historical data to optimize staffing and prep
- **Energy Monitoring**: Track utility usage and optimize for cost savings

### Team Wellness
- **Break Reminders**: Ensure team members take required breaks
- **Hydration Tracking**: Summer heat safety monitoring
- **Ergonomics Alerts**: Prevent repetitive strain injuries
- **Mental Health Resources**: Stress management and support resources

## üìù SESSION NOTES - September 16, 2025

### Major Accomplishments Today ‚úÖ
1. **Eliminated ALL Mock Data**: Systematically removed every instance of hardcoded, mock, or default data
2. **Implemented Manager Updates System**: Full CRUD with forced acknowledgments and signature validation
3. **Fixed User Permission Overrides**: Real database storage and retrieval of custom user permissions
4. **Enhanced Role Configuration**: Persistent role permissions with database storage
5. **Smart Department Detection**: Manager tasks API now intelligently categorizes tasks by content
6. **Added Legal Compliance**: Forced acknowledgment modal with audit trail for critical updates

### Code Quality Improvements
- Fixed TypeScript errors and linting warnings
- Added proper error handling patterns
- Implemented consistent API response formats
- Added comprehensive type definitions

### Database Enhancements
- Created manager_updates table with priority/type fields
- Added update_acknowledgments table with audit trail
- Implemented user_permission_overrides table
- All tables have proper RLS policies

## üîí SECURITY & COMPLIANCE

### Data Protection
- Row Level Security (RLS) on all tables
- Manager-only access to sensitive operations
- Audit trails for all critical actions
- IP address and user agent logging for acknowledgments

### User Privacy
- Minimal data collection
- Secure authentication with NextAuth
- No tracking or analytics without consent
- GDPR-compliant data handling

## üìû COMMUNICATION PROTOCOLS

### User Feedback Loop
1. **User tests feature on live deployment**
2. **User provides specific feedback with screenshots if needed**
3. **Developer implements fixes based on feedback**
4. **Immediate deployment for re-testing**
5. **Repeat until user confirms feature is perfect**

### Success Criteria
- Feature works flawlessly in production
- User can complete intended workflow without issues
- Performance is acceptable (under 3 second load times)
- Mobile compatibility confirmed
- Data persistence verified

---

## üéâ CELEBRATING SUCCESS

We've built an incredible, production-ready task management system that will revolutionize restaurant operations at Jayna Gyro! The foundation is solid, the features are comprehensive, and the potential for growth is unlimited.

**Next session goals**: Fix the 500 errors, polish the UX, and then we're ready to deploy to your real staff for feedback and real-world testing!

---

*This file should be read at the start of every AI development session to ensure continuity and proper development methodology.*